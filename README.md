![a8f564a0c932b82fbd66d847776d5bf](https://github.com/user-attachments/assets/7378cd2b-1c1f-4e0e-93cd-4c661d3c303e)# Simple-Mail-Server
临时起意使用Java语言编写的简易邮件服务器，包含客户端和服务端，功能基础但够用（无前端）

# 设计思路和方案
设计思路上我选择的架构是C/S架构和本地存储架构，技术选型上我选用JAVA做编程语言，TCP协议作为通信协议，多线程和流提供数据处理和响应服务，并将功能分为用户账户管理模块，邮件传输处理模块，用户账户退出模块和邮件存储索引模块。这是简略的整体流程图，大家可以看一下，后面每一步会有更详细的流程。首先，我采用了C/S架构，将邮件服务器的功能分为客户端和服务器两个主要部分。客户端负责用户交互，处理用户的邮件发送、接收和管理的请求；服务器端则负责处理这些请求，并将结果进行反馈。在存储架构上，我选择的是本地架构，通过多个数据文件来管理账户和邮件数据。
![50c66db351b879be8e7e25da3a87bdc](https://github.com/user-attachments/assets/d363b06a-4ebc-45e9-bc8f-517353f21022)


其次，在技术选型上我选择了Java作为编程语言，TCP/IP协议作为网络通信协议，多线程和流技术作为数据处理与响应的手段。这些技术的应用不仅提高了系统的并发处理能力和数据传输效率，还确保了系统的稳定性和可靠性。

再次，在功能模块划分上我设计了用户账户管理模块、邮件传输与处理模块、邮件存储与索引模块和用户账户退出模块。每个模块都有清晰的功能定义和职责分工，通过定义良好的接口实现模块间的通信与协作。

以下是每个模块的功能，用户账户管理模块的主要功能有用户注册和用户登录。用户注册功能，客户端与服务端之间通过Socket建立TCP/IP连接，客户端将注册的信息发送给服务端，服务端进行接收，对信息进行一系列的校验，最终返回给客户端，客户端收到后会向用户展示注册结果，并终止Socket的连接；用户登录功能，首先客户端会与服务端建立Socket连接，并向服务端发送用户的登录信息。服务端收到后会从本地的用户文件中读取用户的身份信息进行校验，最终返回登录的结果。如果结果为真，则会创建线程并添加集合进行管理。客户端收到结果为真的消息后，会在主线程下创建子线程并添加线程集合，启动的子线程会与服务端的子线程保持连接，从而进行后续的通信。
![a8f564a0c932b82fbd66d847776d5bf](https://github.com/user-attachments/assets/d708ef94-f64a-4b4a-8ab8-8f8632d34ead)

邮件传输处理模块的主要功能，有邮件发送，邮件接收和邮件转发以及离线接收功能。其中邮件的发送和接收在邮件服务器的每一步操作中都有体现。这里主要讲一下邮件转发功能和离线接收功能的大致流程。首先客户端选择邮件发送功能并指定接收者，编辑邮件内容，判断用户是否要发送附件。如果是则进行校验判断其是否合法，通过则会发送邮件给与之相连的服务端线程。服务端子线程收到邮件后，检查接收者是否有效，再判断其是否包含附件，开启转发服务。服务端进一步验证接收用户信息是判断其是否在线，如果在线则获取接收者线程并向接收者发送邮件。接收者子线程收到邮件后，首先判断邮件的类型是否为集合，再判断请求类型，通过验证则打印并保存邮件。如果处于离线状态则会将邮件及附件内容存入集合当中，待其上线后进行转发。
![339bbf14036d248ba055d33dc8750eb](https://github.com/user-attachments/assets/063c0cfa-bb2b-4279-854b-5d26ffddfe5d)


其余两个模块，存储与索引模块和账户退出模块放在这里一起说。存储与索引模块的主要功能是存储与索引，这里重点讲一下邮件索引。首先用户选择索引功能，输入索引内容编辑索引邮件后向服务端发送索引邮件。服务端的子线程收到邮件后，判断其为索引邮件并开启索引服务。读取要索引的内容并查找与其相关的邮件，找到后更改邮件类型并将其添加到集合当中。拿到发送者的线程原路返回。客户端接收到集合后，判断其类型再展示索引的结果。
![924f46c754b341343b91c310a215ae2](https://github.com/user-attachments/assets/f11f8f05-61ec-4f39-860a-10c092805418)


账户退出模块的主要功能是用户账户退出。用户选择退出，客户端编辑并发送退出邮件后结束进程，关闭Socket，退出循环。服务器接收后鉴定请求类型并开启退出服务。获得发送者线程后将集合中的线程移除并更改登录状态，关闭Socket，退出循环。
